<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/pages/template/systemModel.xhtml">



	<!-- MENU
	<ui:define name="menu">
		<ui:include src="/pages/includes/menuPrincipal.xhtml">
		</ui:include>
	</ui:define>  -->



	<!-- CONTENT -->
	<ui:define name="content">
		
		<!-- MENU -->
		<ui:include src="/pages/includes/menuPrincipal.xhtml"/>
		
		
		<!-- BODY -->
		<!-- LISTING PANEL FORM -->
		<div>
			<br/>
			<h:form id="contractModelListFormID">
				<p:panel header="Lista de Modelo de Contrato">
					<p:dataTable id="contractModelDataTableFormID" emptyMessage="Nenhum registro encontrado."
						paginator="true" value="#{contractModelController.contractModelsDomain}" var="cursor" rows="10"
						resizableColumns="true" resizeMode="fit" reflow="true" rowHover="true"
						draggableColumns="true">
	
						
						<!-- NM_CONTRACT_MODEL -->
						<p:column headerText="Nome completo" sortBy="#{cursor.completeName}" filterBy="#{cursor.contractModelName}">
							<h:outputText value="#{cursor.contractModelName}"/>
						</p:column>
	
						<!-- OPTIONS -->
						<p:column headerText="Opções" id="optionID">
	
							<!-- BUTTON TO EDIT -->
							<p:commandButton icon="fa fa-edit" actionListener="#{contractModelController.doEdit}"
											oncomplete="PF('dlgTextEditContractModel').show();"
											update=":idMsgGlobal 
													:contractModelRegisterFormID:contractModelInputRegisterFormID 
													:contractModelRegisterFormID:contractModelInputRegisterTextFormID
													:contractModelRegisterFormID:contractModelInputRegisterUserFormID
													:contractModelListFormID:contractModelDataTableFormID">
								<f:attribute name="selectedPersonByCursor" value="#{cursor}"/>
								<f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
							</p:commandButton>
						
							<!-- BUTTON TO DELETE -->
							<p:commandButton icon="fa fa-trash" actionListener="#{contractModelController.doDelete}"
											update=":idMsgGlobal 
													:contractModelListFormID:contractModelDataTableFormID">
								<p:confirm header="Confirmação" message="Deseja excluir #{cursor.contractModelName}?" icon="ui-icon-alert"/>
								<f:attribute name="selectedPersonByCursor" value="#{cursor}"/>
							</p:commandButton>
						</p:column>
	
	
						<!-- FACET FOR THE FOOTER -->
						<f:facet name="footer">
							
							<!-- RETURN TO CONTRACT PAGE -->
							<p:commandButton value="Voltar" action="client.contract" icon="fa fa-reply"/>
								
							<!-- NEW BUTTON -->
							<p:commandButton value="Novo" icon="fa fa-plus"
								actionListener="#{contractModelController.doNewRegister}"
								oncomplete="PF('dlgTextEditContractModel').show();"
								update=":contractModelRegisterFormID:contractModelInputRegisterFormID 
										:contractModelRegisterFormID:contractModelInputRegisterTextFormID
										:contractModelRegisterFormID:contractModelInputRegisterUserFormID
										:contractModelRegisterFormID:editorID">
								<f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener"/>
							</p:commandButton>
							
						</f:facet>
	
					</p:dataTable>
	
					
					<!-- CONFIRM DIALOG WHEN DELETING -->
					<p:confirmDialog global="true" >
						<p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>		
						<p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
					</p:confirmDialog>
					
				</p:panel>
			</h:form>
			



			<!-- DIALOG TO REGISTER NEW CONTRACT BODY TEXT -->			
			<p:dialog header="Editar Texto do Contrato" widgetVar="dlgTextEditContractModel"
				draggable="true" modal="true" closable="true"
				appendTo="@(body)" closeOnEscape="true"
				responsive="true" maximizable="true" position="top">
				
				
				<!-- FORM FOR THE DIALOG -->
				<h:form id="contractModelRegisterFormID">
					
					<!-- PANEL GRID FOR REGISTER CONTRACT MODEL NAME AND COMMENT -->
					<h:panelGrid id="contractModelInputRegisterFormID" columns="2">									    
						<p:outputLabel value="Nome do Modelo: *" />
						<p:inputText value="#{contractModelController.contractModelDomain.contractModelName}" maxlength="40" size="27"
									required="true" requiredMessage="O campo 'Nome do Modelo' é obrigatório"/>
												
						<p:outputLabel value="Comentário: " />
						<p:inputTextarea value="#{contractModelController.contractModelDomain.commentDescription}" rows="2" cols="30" counter="display"
							maxlength="100" counterTemplate="{0} caracteres restantes."
							autoResize="true"/>
						<br/>
						<h:outputText id="display"/>
					</h:panelGrid>		
					
					
					<p:spacer height="10px"/>
					
					<!-- PANEL GRID FOR EDITOR -->
					<h:panelGrid id="contractModelInputRegisterTextFormID" columns="1">
					    <p:editor id="editorID" widgetVar="textEditor" value="#{contractModelController.textFromEditor}" width="600"/>
					</h:panelGrid>
					
					
					<p:spacer height="10px"/>
					
					<!-- PANEL GRID FOR USER AND SAVING DATE -->
					<h:panelGrid id="contractModelInputRegisterUserFormID" columns="2">
						<p:outputLabel value="Ultima atualização: "/>
						<p:spacer width="5px"/>
						<p:outputLabel value="Feita no dia: "/>
						<p:outputLabel value="#{contractModelController.contractModelDomain.saveContractModelDate}">
							<f:convertDateTime locale="pt_BR" pattern="dd/MM/yyyy HH:mm"
												timeZone="America/Sao_Paulo"/>
						</p:outputLabel>												
						<p:outputLabel value="Pelo usário: "/>
						<p:outputLabel value="#{contractModelController.contractModelDomain.contractModelSaveLoginUser}" style="color: orange;"/>						
					</h:panelGrid>
					
					<!-- PANEL GRID FOR BUTTON VIEW, PDFVIEW, CLEAR, SAVE AND CLOSE -->
					<h:panelGrid columns="6" id="buttonPannelGridID">
					    <p:commandButton value="Visualizar" update="displayContractModelID" oncomplete="PF('dlgView').show()" icon="fa fa-eye" />
						<p:commandButton value="Contrato" icon="fa fa-file-pdf-o" action="#{contractController.doShowContractReport}"
						 				ajax="false" onclick="this.form.target='_blank'"/>
					    <p:commandButton value="Limpar" type="button" onclick="PF('textEditor').clear();" icon="fa fa-eraser" />
						<p:spacer height="100px"/>				
						<p:commandButton value="Fechar" icon="fa fa-close" oncomplete="PF('dlgTextEditContractModel').hide();" />
						<p:commandButton value="Salvar" icon="fa fa-floppy-o" actionListener="#{contractModelController.doSave}"
										update=":idMsgGlobal 
												:contractModelRegisterFormID:contractModelInputRegisterFormID 
												:contractModelRegisterFormID:contractModelInputRegisterTextFormID
												:contractModelRegisterFormID:contractModelInputRegisterUserFormID
												:contractModelListFormID:contractModelDataTableFormID"/>																		
					</h:panelGrid>
					
					
					<!-- DIALOG TO SHOW TEXTEDITOR RESULT -->
				    <p:dialog header="Conteúdo do Corpo do Contrato" widgetVar="dlgView" showEffect="fade" hideEffect="fade"
				    		appendTo="@(body)" closeOnEscape="true" closable="true">				    		
				        <p:outputPanel id="displayContractModelID">
				            <h:outputText value="#{contractModelController.textFromEditor}" escape="false" />
				        </p:outputPanel>				        
				    </p:dialog>  
				       
				</h:form>
			</p:dialog>			
			
		</div>
	</ui:define>
</ui:composition>