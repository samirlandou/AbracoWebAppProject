<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	template="/pages/template/systemModel.xhtml">



	<!-- MENU
	<ui:define name="menu">
		<ui:include src="/pages/includes/menuPrincipal.xhtml">
		</ui:include>
	</ui:define>  -->



	<!-- CONTENT -->
	<ui:define name="content">
		
		<!-- MENU -->
		<ui:include src="/pages/includes/menuPrincipal.xhtml"/>
		
		
		<!-- BODY -->
		<!-- LISTING PANEL FORM -->
		<div>
			<br/>
			<h:form id="personListFormId">
			
				<h3 align="center">Lista de Pessoas</h3>
				<br/>
				<p:dataTable id="personDataTableFormId" emptyMessage="Nenhum registro encontrado."
					paginator="true" value="#{personController.personsDomain}" var="cursor" rows="10"
					resizableColumns="true" resizeMode="fit" reflow="true" rowHover="true"
					draggableColumns="true" style="text-align: center; width:90%; margin: 0 auto;">

					
					<!-- NM_COMPLETE_NAME -->
					<p:column headerText="Nome completo"
							sortBy="#{cursor.completeName}"
							filterBy="#{cursor.completeName}">
						<h:outputText value="#{cursor.completeName}"/>
					</p:column>

					<!-- DE_COUNTRY -->
					<p:column headerText="País"  style="width: 12%; text-align: center;">
						<h:outputText value="#{cursor.country.equals('República Democrática do Congo')? 'RDC' : cursor.country}"/>
					</p:column>

					<!-- DE_SEX -->
					<p:column headerText="Sexo" sortBy="#{cursor.sex}" style="width: 5%; text-align: center;">
						<h:outputText value="#{cursor.sex}"/>					
					</p:column>

					<!-- DE_EMAIL -->
					<p:column headerText="E-mail">
						<h:outputText value="#{cursor.email}" style="width: 15%; text-align: center;"/>
					</p:column>

					<!-- DE_TELEPHONE -->
					<p:column headerText="Telefone"  style="width: 9%; text-align: center;">
						<h:outputText value="#{cursor.telephone}"/>
					</p:column>
					
					<!-- DE_LANGUAGE -->
					<p:column headerText="Língua" sortBy="#{cursor.language}"
							  filterBy="#{cursor.language}" style="width: 7%; text-align: center;">
						<h:outputText value="#{cursor.language}"/>
					</p:column>

					<!-- DE_PROFILE -->
					<p:column headerText="Perfil" sortBy="#{cursor.profile}" style="width: 11%; text-align: center;" >
						<h:outputText value="#{cursor.profile}"/>
					</p:column>

					<!-- DE_STATUS -->
					<p:column headerText="Status" sortBy="#{cursor.status}" style="width: 6%; text-align: center;">
						<h:outputText value="#{cursor.status == true? 'Ativo' : 'Inativo'}"/>					
					</p:column>
					
					<!-- OPTIONS -->
					<p:column headerText="Opções" style="width: 8%; text-align: center;">

						<!-- BUTTON TO EDIT -->
						<p:commandButton icon="fa fa-edit" actionListener="#{personController.doEdit}"
										title="Editar Registro"
										oncomplete="PF('dlgNewPerson').show();"
										update=":idMsgGlobal
												:personRegisterFormId:personInputRegisterFormId
												:personListFormId:personDataTableFormId">
												
							<f:attribute name="selectedPersonByCursor" value="#{cursor}"/>
							<f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>
					
						<!-- BUTTON TO DELETE -->
						<p:commandButton icon="fa fa-trash" actionListener="#{personController.doDelete}"
										title="Deletar Registro"
										update=":idMsgGlobal
												:personListFormId:personDataTableFormId">
												
							<p:confirm header="Confirmação" message="Deseja excluir #{cursor.completeName}?" icon="ui-icon-alert"/>
							<f:attribute name="selectedPersonByCursor" value="#{cursor}"/>
						</p:commandButton>
					</p:column>


					<!-- FACET FOR THE FOOTER -->
					<f:facet name="footer">

						<!-- NEW BUTTON -->
						<p:commandButton value="Novo"
										icon="fa fa-plus"
										title="Novo Registro"
										actionListener="#{personController.doNewRegister}"
										oncomplete="PF('dlgNewPerson').show();"
										update=":personRegisterFormId:personInputRegisterFormId">
							
							<f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener"/>
						</p:commandButton>
						
						<!-- CHOOSE DATA TABLE COLOMNS  -->
						<p:commandButton value="Colunas"
						 				  type="button" 
						 				  id="columnsDataTableID"
						 				  icon="fa fa-edit"/>
						 				  
						<p:columnToggler datasource="personDataTableFormId"
						 				  trigger="columnsDataTableID">
						</p:columnToggler>
						 
					</f:facet>

				</p:dataTable>

				
				<!-- CONFIRM DIALOG WHEN DELETING -->
				<p:confirmDialog global="true" >
				
					<p:commandButton value="Sim" 
									type="button" 
									styleClass="ui-confirmdialog-yes" 
									icon="fa fa-check"/>
											
					<p:commandButton value="Não" 
									type="button" 
									styleClass="ui-confirmdialog-no" 
									icon="fa fa-close"/>
				</p:confirmDialog>
					
			</h:form>
	
	
			<!-- DIALOG TO REGISTER NEW USER-->
			<p:dialog header="Cadastrar Nova Pessoa" widgetVar="dlgNewPerson"
				draggable="false" resizable="false" modal="true" closable="true"
				appendTo="@(body)">
	
				<!-- FORM FOR THE DIALOG -->
				<h:form id="personRegisterFormId">
				
					<!-- PANEL GRID TO FILL FORMS -->
					<h:panelGrid id="personInputRegisterFormId" columns="2">
					
						<p:outputLabel value="Nome Completo: *" />
						<p:inputText value="#{personController.personDomain.completeName}" maxlength="40" size="27"
									required="true" requiredMessage="O campo 'Nome Completo' é obrigatório"/>

						<p:outputLabel value="CPF: *" />
						<p:inputMask value="#{personController.personDomain.cpf}" maxlength="40" size="27"
									mask="999.999.999-99"
									required="true" requiredMessage="O campo 'CPF' é obrigatório">
									<p:ajax event="change"
											process="@this"
											global="false"
											listener="#{personController.doValidateCPF}" 
											update=":idMsgGlobal" />									
						
						</p:inputMask>
						
						<p:outputLabel value="País: *" />																					   
						<p:selectOneMenu id="countryComboID"
										 filter="true"
										 value="#{personController.personDomain.country}"
										 converter="omnifaces.SelectItemsConverter" 
										 required="true" 
										 requiredMessage="O campo 'País' é obrigatório">
										 
										 <f:selectItem noSelectionOption="true" itemLabel="Escolhe o país"/>
										 <f:selectItems value="#{personController.country}"
										 				var="countryVar"
										 				itemValue="#{countryVar}"
										 				itemLabel="#{countryVar}"/>								
						</p:selectOneMenu>
	
						<p:outputLabel value="Sexo: *" />
						<p:selectOneRadio value="#{personController.personDomain.sex}" 
										required="true" requiredMessage="O campo 'Sexo' é obrigatório">
							<f:selectItem itemLabel="Masculino" itemValue="M" />
							<f:selectItem itemLabel="Feminino" itemValue="F" />
						</p:selectOneRadio>
	
						<p:outputLabel value="E-mail: *" />
						<p:inputText value="#{personController.personDomain.email}" maxlength="60" size="27"
									required="true" requiredMessage="O campo 'E-mail' é obrigatório">
									<p:ajax event="change"
											process="@this"
											global="false"
											listener="#{personController.doValidateEmail}" 
											update=":idMsgGlobal" />
						</p:inputText>
						
						<p:outputLabel value="Telefone: *" />
						<p:inputMask  value="#{personController.personDomain.telephone}" mask="(99)99999-9999"
									required="true" requiredMessage="O campo 'Telefone' é obrigatório">
						</p:inputMask>
						
						<p:outputLabel value="Endereço: " />
						<p:inputTextarea value="#{personController.personDomain.address}" rows="2" cols="30" counter="display"
							maxlength="100" counterTemplate="{0} caracteres restantes."
							autoResize="true"/>
						<br/>
						<h:outputText id="display"/>
						<br/>
						<p:spacer height="20px"/>
						
						<p:outputLabel value="Língua: *" />
						<p:selectOneMenu id="linguaComboId" filter="false" value="#{personController.personDomain.language}"
							converter="omnifaces.SelectItemsConverter" required="true" requiredMessage="O campo 'Língua' é obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione uma Língua" />
							<f:selectItem itemLabel="ÁRABE" itemValue="AR"/>
							<f:selectItem itemLabel="ESPANHOL" itemValue="ES"/>
							<f:selectItem itemLabel="FRANCÊS" itemValue="FR"/>
							<f:selectItem itemLabel="INGLÊS" itemValue="EN"/>
							<f:selectItem itemLabel="PORTUGUÊS" itemValue="BR"/>
						</p:selectOneMenu>
						
						<p:outputLabel value="Perfil: *" />
						<p:selectOneMenu id="perfilComboId" filter="false" value="#{personController.personDomain.profile}"
							converter="omnifaces.SelectItemsConverter" required="true" requiredMessage="O campo 'Perfil' é obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione um perfil" />
							<f:selectItem itemLabel="ESTUDANTE" itemValue="ESTUDANTE"/>
							<f:selectItem itemLabel="PROFESSOR(A)" itemValue="PROFESSOR(A)"/>
							<f:selectItem itemLabel="COORDENADOR(A)" itemValue="COORDENADOR(A)"/>
						</p:selectOneMenu>
						
						<p:outputLabel value="Status: *" />
						<p:toggleSwitch value="#{personController.personDomain.status}">
							<p:ajax listener="#{personController.addMessage}" update=":idMsgGlobal" />
						</p:toggleSwitch>
						<br/>			
					</h:panelGrid>
					
					<br/>				
					<!-- PANEL GRID FOR BUTTON SAVE AND CLOSE -->
					<h:panelGrid columns="2" styleClass="panelGridCenter">
						<p:commandButton value="Salvar" icon="fa fa-floppy-o" actionListener="#{personController.doSave}"
										title="Salvar Registro"
										update=":idMsgGlobal
												:personRegisterFormId:personInputRegisterFormId
												:personListFormId:personDataTableFormId"/>
														
						<p:commandButton value="Fechar"
										title="Sair do Registro"
										icon="fa fa-remove"
										oncomplete="PF('dlgNewPerson').hide();"/>
					</h:panelGrid>		
					
				</h:form>
	
			</p:dialog>
		</div>
	</ui:define>
</ui:composition>